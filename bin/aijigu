#!/usr/bin/env bash
set -euo pipefail

PROGRAM_NAME="$(basename "$0")"
VERSION="0.1.0"

usage() {
  cat <<EOF
aijigu - Automation framework powered by Claude CLI

Usage:
  ${PROGRAM_NAME} <command> [options]
EOF
}

if [[ $# -eq 0 ]]; then
  usage
  exit 1
fi

AIJIGU_ROOT="$(cd "$(dirname "$0")/.." && pwd)"
export AIJIGU_ROOT

source "$AIJIGU_ROOT/lib/prompts.bash"

COMMAND="$1"
shift

case "$COMMAND" in
  _run)
    source "$AIJIGU_ROOT/lib/commands/run.bash"
    command_run "$@"
    ;;
  direction)
    source "$AIJIGU_ROOT/lib/commands/direction.bash"
    command_direction "$@"
    ;;
  _notify)
    source "$AIJIGU_ROOT/lib/commands/notify.bash"
    command_notify "$@"
    ;;
  web)
    source "$AIJIGU_ROOT/lib/commands/web.bash"
    command_web "$@"
    ;;
  _utils)
    source "$AIJIGU_ROOT/lib/commands/utils.bash"
    command_utils "$@"
    ;;
  *)
    echo "${PROGRAM_NAME}: unknown command '${COMMAND}'" >&2
    usage >&2
    exit 1
    ;;
esac
